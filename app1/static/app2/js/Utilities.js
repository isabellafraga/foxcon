function EstaConectado(){if(navigator.onLine==false){Notificacao('SemConexao','Verifique a sua conexão com a internet.');return false;}else{return true;}}
function Notificacao(Type,Msg){var opcoes={type:'success',title:'Sucesso!',text:'Salvo com sucesso.',icon:'fa fa-check',delay:'2000',nonblock:{nonblock:true,nonblock_opacity:.2}}
switch(Type){case 'Sucesso':opcoes.type="success";opcoes.text=Msg;break
case 'Erro':opcoes.type="error";opcoes.icon='fa fa-close';opcoes.title="Alerta!";opcoes.text=Msg;break;case 'Info':opcoes.type="info";opcoes.icon='fa fa-info';opcoes.title="Comunicado!";opcoes.text=Msg;break;case 'SemConexao':opcoes.type="warning";opcoes.icon='fa fa-thumbs-down';opcoes.title="Você está Off-line!";opcoes.text=Msg;break;case 'Conectado':opcoes.type="success";opcoes.icon='fa fa-thumbs-up';opcoes.title="Online! ;)";opcoes.text=Msg;break;}
new PNotify(opcoes);}
jQuery("input.telefone").mask("(99) 9999-9999?9").focusout(function(event){var target,phone,element;target=(event.currentTarget)?event.currentTarget:event.srcElement;phone=target.value.replace(/\D/g,'');element=$(target);element.unmask();if(phone.length>10){element.mask("(99) 99999-999?9");}else{element.mask("(99) 9999-9999?9");}});$(".money").maskMoney({prefix:"R$:",decimal:",",thousands:"."});function LimparForm(FormId){$('#'+FormId).validate().resetForm();$('input:checkbox').removeAttr('checked');$('input:radio').removeAttr('checked');$('#'+FormId).each(function(){this.reset();SlimModal.slim('remove');});$('.summernote').summernote('code','');$('#'+FormId+' #erro-validation').html('');$('#'+FormId+' .has-error').each(function(){$('#'+FormId+' .has-error').toggleClass('has-error','Remove');});$('.selectTwo').val(null).trigger('change');}
$('.LimparForm').on('click',function(){var FormId=$(this).closest("form").attr("id");LimparForm(FormId);});$(".Cancelar").click(function(){$("#ModalCreate").hide();$("#dataTable").show();});var ValidateOpt={ignore:":hidden:not(.summernote),.note-editable.panel-body",highlight:function(label){$(label).closest('.form-group').removeClass('has-success').addClass('has-error');},success:function(label){$(label).closest('.form-group').removeClass('has-error');label.remove();},errorPlacement:function(error,element){var placement=element.closest('.input-group');if(!placement.get(0)){placement=element;}
if(error.text()!==''){placement.after(error);}},}
$("#FormAlterarSenha").validate({rules:{senha:{minlength:6,maxlength:20},senhasIgual:{equalTo:"#senha"}}});function modalOpen(TPform,ModalId,Id,NomeRegistro){var FormId=$('#'+ModalId+' form').attr('id');if(!!NomeRegistro){$('#'+FormId+' .NomeRegistro').html("' "+NomeRegistro+" '");}
if($('#'+ModalId+' .dropzone').length){DropZone.removeAllFiles();$('#'+ModalId+' .dzArqNome').val();}
if(TPform==='Create'){LimparForm(FormId);$('#'+FormId).attr('action',$('#'+FormId).data('action-create'));if($('#'+ModalId).hasClass('modal')){$('#'+ModalId).modal('show');}else{$('#'+ModalId).show();$('#dataTable').hide();}}else if(TPform==='Edit'){$('input:checkbox').removeAttr('checked');var conectado=Details(FormId,Id);$('#'+FormId).attr('action',$('#'+FormId).data('action-edit')+'/'+Id);if(conectado!=false){if($('#'+ModalId).hasClass('modal')){$('#'+ModalId).modal('show');}else{$('#'+ModalId).show();$('#dataTable').hide();}}}else{$('#'+FormId).attr('action',$('#'+FormId).data('action-delete')+'/'+Id);if($('#'+ModalId).hasClass('modal')){$('#'+ModalId).modal('show');}else{$('#'+ModalId).show();$('#dataTable').hide();}}}
function Details(FormId,Id,ModalId){if(EstaConectado()){var Action=$('#'+FormId).data('action-details')+'/'+Id;$.ajax({type:'post',url:Action,beforeSend:function(){$('body').addClass('loading-overlay-showing');},success:function(data){var obj=JSON.parse(data);var n=0;$.each(obj,function(key,val){$('#'+FormId+' [name='+key+']').val(val);$('#'+FormId+' [name='+key+']').attr('checked',true);if(key==='SlimImg'){$.each(val,function(SlimNum,SlimImg){$('[name="slim['+SlimNum+']"]').parent().slim('load',SlimImg);});}
if(key==='Texto'&&$('#'+FormId+' [name=Texto]').hasClass('summernote')){$('.summernote').summernote('code',val);}
for(var i=0;i<key.length;i++){if($('#'+FormId+' .dropzone').length&&key==='DropZone'+i){var mockFile={name:val,size:12345,accepted:true};DropZone.options.addedfile.call(DropZone,mockFile);DropZone.options.thumbnail.call(DropZone,mockFile,"Assets/images/thumbs/thumb-"+val);DropZone.options.complete.call(DropZone,mockFile);DropZone.files.push(mockFile);$(DropZoneId).find('[data-dz-legenda-acessivel]:eq('+i+')').attr('name',val.substr(0,val.lastIndexOf('.')));$('.dz-progress').css('display','none');var nomes=$(DropZoneId+' .dzArqNome').val();nomes=nomes+val+' ';$(DropZoneId+' .dzArqNome').val(nomes);}}});},error:function(data){Notificacao('Erro','Não foi possível concluir a operação.<br>Por favor, tente novamente.');}}).done(function(data){$('body').removeClass('loading-overlay-showing');});}else{return false;}}
function SalvarForm(FormId,ModalId,Msg){if(EstaConectado()){$.ajax({type:'post',url:$('#'+FormId).attr('action'),data:$('#'+FormId).serialize(),beforeSend:function(){$('body').addClass('loading-overlay-showing');if($('#'+ModalId).is(':visible')){$('#'+ModalId).modal('hide');}else{$('#'+ModalId).modal('show');}},success:function(data){if($('#'+ModalId).hasClass('formPalco')==true){$('#'+ModalId).hide();$('#dataTable').show();}else{$('#'+ModalId).modal('hide');}
$table.fnDraw(false);Notificacao('Sucesso',Msg);},error:function(data){Notificacao('Erro','Não foi possível concluir a operação.<br>Por favor, tente novamente.');}}).done(function(data){$('body').removeClass('loading-overlay-showing');LimparForm(FormId);});}}
$(".SalvarForm").click(function(){var FormId=$(this).closest("form").attr("id");var ModalId=($(this).closest('.formPalco').hasClass('formPalco'))?$(this).closest('.formPalco').attr('id'):$(this).closest('.modal').attr('id');var Msg=$('#'+FormId).data('msg-sucesso');var SlimExist=$('#'+FormId+' .slim').data('state');if($('#'+FormId+' .dropzone').length){if($('#'+FormId+' .dropzone').data('dz-valid')==1||DropZone.getUploadingFiles().length!==0){var DZValide=0;if(DropZone.files.length===0){alert('Por favor, adicione fotos na galeria.');}else if(DropZone.getUploadingFiles().length!==0){alert('Por favor, aguarde finalizar o uploads das imagens da galeria.');}else if(DropZone.getUploadingFiles().length===0){DZValide=1;}}}else{var DZValide=1;}
if($("#"+FormId).valid(ValidateOpt)&&SlimExist!='empty,error'&&DZValide!=0){SalvarForm(FormId,ModalId,Msg);}});$(document).ready(function(){$(".btnExport").click(function(){var TabelaId=$(this).data('table-id');$("#"+TabelaId).find('.dt-opcoes').css('display','none');$("#"+TabelaId).btechco_excelexport({containerid:TabelaId,datatype:$datatype.Table,filename:'Tabela_Excel'});$("#"+TabelaId).find('.dt-opcoes').css('display','');});});Dropzone.autoDiscover=false;var OptDropZone={dictDefaultMessage:'Clique para adicionar os arquivos.',autoDiscover:false,maxFilesize:15,parallelUploads:5,maxFiles:null,autoProcessQueue:true,createImageThumbnails:true,thumbnailWidth:70,thumbnailHeight:70,addRemoveLinks:true,dictRemoveFile:'Remover',dictFileTooBig:'Tamanho máximo permitido: {{maxFilesize}}MB.',init:function(){this.on("maxfilesexceeded",function(file){this.removeFile(file);Notificacao('Erro','Não é possível anexar mais arquivos. Limite atingido.');});this.on("addedfile",function(file){ext=file.name.split('.').pop();if(ext==="pdf"||ext==="doc"||ext==="docx"||ext==="xls"||ext==="xlsx"||ext==="ppt"||ext==="pptx"||ext==="txt"||ext==="csv"||ext==="zip"||ext==="rar"||ext==="mp3"||ext==="cdr"||ext==="avi")
{this.emit('thumbnail',file,'assets/stylesheets/Icones/'+ext+'.png');}});this.on("removedfile",function(file,accepted){var ArqExcluir=$(file.previewElement).find('[data-dz-name]').text();var str=$(DropZoneId+' .dzArqNome').val();var str_final=str.replace(ArqExcluir+' ','');$(DropZoneId+' .dzArqNome').val(str_final);});this.on("success",function(file,serverFileName){this.processQueue();var arquivosNomes=$(DropZoneId+' .dzArqNome').val()+serverFileName+' ';$(DropZoneId+' .dzArqNome').val(arquivosNomes);$(file.previewElement).find('[data-dz-name]').text(serverFileName);});}}
var SlimModal=$('.SlimModal').slim();$('.slim').slim();$('.OpenModalLogout').click(function(){$('#ModalLogout').modal('show');});function Logout(){if(EstaConectado()){$.ajax({dataType:'json',type:'post',url:'Login/Logout/',beforeSend:function(){$('body').addClass('loading-overlay-showing');},success:function(data){window.location.href=data.url;},error:function(data){$('body').removeClass('loading-overlay-showing');Notificacao('Erro','Não foi possível concluir a operação.<br>Por favor, tente novamente.');}}).done(function(data){$('body').removeClass('loading-overlay-showing');});}}
OptSummnerNote={lang:'pt-BR',dialogsInBody:true,height:300,toolbar:[['style',['style']],['font',['bold','italic','underline','clear']],['fontname',['fontname']],['color',['color']],['para',['ul','ol','paragraph']],['height',['height']],['table',['table']],['insert',['link','picture','video']],['view',['fullscreen']],['help',['help']]],callbacks:{onImageUpload:function(files){sendFile(files[0]);},onMediaDelete:function(target){console.log($target.attr('src'));}}}
function sendFile(files){var form_data=new FormData();form_data.append('file',files);$.ajax({data:form_data,type:"POST",url:'Utilities/SummerNoteImg',cache:false,contentType:false,processData:false,beforeSend:function(){$('body').addClass('loading-overlay-showing');},success:function(url){$('.summernote').summernote('insertImage',url);}}).done(function(data){$('body').removeClass('loading-overlay-showing');});}
function deleteFile(target)
{$.ajax({data:{src:target},type:"POST",url:'Utilities/SummerNoteImgDelete',cache:false,contentType:false,processData:false,});}
$('.CheckAll').click(function(e){var Classe=$(this).data('checkbox-class');if($(this).is(':checked'))
$('.'+Classe).prop('checked',true);else
$('.'+Classe).prop('checked',false);});var changed=false;function changeLabel(formId){if(!changed){$(formId+' > div:nth-child(13) > label').parent().children('label').html('Celular*');changed=true;}}
function anchorLink(id){$('#navbar').removeClass("show");var offset=document.getElementById(id);var scrollto=offset.offsetTop-120;$('html, body').animate({scrollTop:scrollto},500);}
function hidenButton(el){var display=document.getElementById(el).style.display;if(display=="none")
document.getElementById(el).style.display='block';else
document.getElementById(el).style.display='none';}